var m=typeof globalThis.process<"u"?globalThis.process.argv:[];var y=()=>typeof globalThis.process<"u"?globalThis.process.env:{};var A=new Set(m),_=e=>A.has(e),W=m.filter(e=>e.startsWith("--")&&e.includes("=")).map(e=>e.split("=")).reduce((e,[t,s])=>(e[t]=s,e),{});var U=_("--dry-run"),g=()=>_("--verbose")||y().VERBOSE==="true",I=g();var f=(e="",...t)=>console.log(e.padEnd(9),"|",...t);var v=(...e)=>console.error("\u{1F534} ERROR".padEnd(9),"|",...e),b=(...e)=>f("\u{1F535} INFO",...e),h=(...e)=>f("\u{1F7E0} WARN",...e),M=0,c=(...e)=>g()&&f(`\u{1F7E1} ${M++}`,...e);var o=__plasmo_runtime_data__;module.bundle.HMR_BUNDLE_ID=o.bundleId;globalThis.process={argv:[],env:{VERBOSE:o.verbose}};var T=module.bundle.Module;function D(e){T.call(this,e),this.hot={data:module.bundle.hotData[e],_acceptCallbacks:[],_disposeCallbacks:[],accept:function(t){this._acceptCallbacks.push(t||function(){})},dispose:function(t){this._disposeCallbacks.push(t)}},module.bundle.hotData[e]=void 0}module.bundle.Module=D;module.bundle.hotData={};var l=globalThis.chrome||globalThis.browser||null;function u(){return!o.host||o.host==="0.0.0.0"?location.protocol.indexOf("http")===0?location.hostname:"localhost":o.host}function p(){return o.port||location.port}var B=`${o.secure?"https":"http"}://${u()}:${p()}/`;async function x(e=1470){for(;;)try{await fetch(B);break}catch{await new Promise(s=>setTimeout(s,e))}}if(l.runtime.getManifest().manifest_version===3){let e=l.runtime.getURL("/__plasmo_hmr_proxy__?url=");globalThis.addEventListener("fetch",function(t){let s=t.request.url;if(s.startsWith(e)){let n=new URL(decodeURIComponent(s.slice(e.length)));n.hostname===o.host&&n.port===`${o.port}`?(n.searchParams.set("t",Date.now().toString()),t.respondWith(fetch(n).then(r=>new Response(r.body,{headers:{"Content-Type":r.headers.get("Content-Type")??"text/javascript"}})))):t.respondWith(new Response("Plasmo HMR",{status:200,statusText:"Testing"}))}})}function R(e,t){let{modules:s}=e;return s?!!s[t]:!1}function k(e=p()){let t=u();return`${o.secure||location.protocol==="https:"&&!/localhost|127.0.0.1|0.0.0.0/.test(t)?"wss":"ws"}://${t}:${e}/`}function S(e){typeof e.message=="string"&&v("[plasmo/parcel-runtime]: "+e.message)}function L(e){if(typeof globalThis.WebSocket>"u")return;let t=new WebSocket(k(Number(p())+1));return t.addEventListener("message",async function(s){if(JSON.parse(s.data).type==="build_ready"){await e();return}}),t.addEventListener("error",S),t}function E(e){if(typeof globalThis.WebSocket>"u")return;let t=new WebSocket(k());return t.addEventListener("message",async function(s){let n=JSON.parse(s.data);if(n.type==="update"&&await e(n.assets),n.type==="error")for(let r of n.diagnostics.ansi){let i=r.codeframe||r.stack;h("[plasmo/parcel-runtime]: "+r.message+`
`+i+`

`+r.hints.join(`
`))}}),t.addEventListener("error",S),t.addEventListener("open",()=>{b(`[plasmo/parcel-runtime]: Connected to HMR server for ${o.entryFilePath}`)}),t.addEventListener("close",()=>{h(`[plasmo/parcel-runtime]: Connection to the HMR server is closed for ${o.entryFilePath}`)}),t}var w=module.bundle.parent,a={buildReady:!1,hmrUpdated:!1,csCodeChanged:!1,ports:new Set};async function d(e=!1){if(e||a.buildReady&&(a.hmrUpdated||a.csCodeChanged)){c("BGSW Runtime - reloading");let t=await chrome.tabs.query({active:!0});for(let s of a.ports){let n=t.some(r=>r.id===s.sender.tab.id);s.postMessage({__plasmo_cs_active_tab__:n})}l.runtime.reload()}}if(!w||!w.isParcelRequire){let e=E(async t=>{c("BGSW Runtime - On HMR Update"),a.hmrUpdated||=t.filter(n=>n.envHash===o.envHash).some(n=>R(module.bundle,n.id));let s=t.find(n=>n.type==="json");if(s){let n=new Set(t.map(i=>i.id)),r=Object.values(s.depsByBundle).map(i=>Object.values(i)).flat();a.hmrUpdated||=r.every(i=>n.has(i))}d()});e.addEventListener("open",()=>{let t=setInterval(()=>e.send("ping"),24e3);e.addEventListener("close",()=>clearInterval(t))}),e.addEventListener("close",async()=>{await x(),d(!0)})}L(async()=>{c("BGSW Runtime - On Build Repackaged"),a.buildReady||=!0,d()});l.runtime.onConnect.addListener(function(e){e.name.startsWith("__plasmo_runtime_script_")&&(a.ports.add(e),e.onDisconnect.addListener(()=>{a.ports.delete(e)}),e.onMessage.addListener(function(t){t.__plasmo_cs_changed__&&(c("BGSW Runtime - On CS code changed"),a.csCodeChanged||=!0,d())}))});l.runtime.onMessage.addListener(function(t){return t.__plasmo_full_reload__&&(c("BGSW Runtime - On top-level code changed"),d()),!0});
